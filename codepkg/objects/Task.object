<?xml version="1.0" encoding="UTF-8"?>
<CustomObject xmlns="http://soap.sforce.com/2006/04/metadata">
    <webLinks>
        <fullName>Send_Doc_HCP_Site</fullName>
        <availability>online</availability>
        <displayType>massActionButton</displayType>
        <linkType>javascript</linkType>
        <masterLabel>Send Doc - HCP/Site</masterLabel>
        <openType>onClickJavaScript</openType>
        <protected>false</protected>
        <requireRowSelection>true</requireRowSelection>
        <url>{!REQUIRESCRIPT(&quot;/xdomain/xdomain.js&quot;)}
{!REQUIRESCRIPT(&quot;/support/console/28.0/integration.js&quot;)}

try {
	var generalURL = &apos;/apex/HCPSITE_FullfilmentPicker?Id={!Case.Id}&apos;;
	var zPaperURL = &quot;https://{!$Setup.ZPAPER__zpaper__c.ZPAPER__server__c}/kb/jsp/massFaxBin.jsp?sfUser={!$User.Username}&amp;sfOrg={!$Organization.Id}&amp;sfIDs={!Case.Id},{!Lead.Id},{!Contact.Id},{!Opportunity.Id},{!Account.Id}&amp;mode=firstOne&amp;optOut={!Lead.HasOptedOutOfFax}{!Contact.HasOptedOutOfFax}&amp;sendTo={!Lead.Fax},{!Account.Fax},{!Contact.Fax}&amp;SFserver={!$Api.Partner_Server_URL_310}&amp;SFsession={!$Api.Session_ID}&quot;;
	var productName = &quot;{!Case.Product}&quot;.toUpperCase();
	var zPaperSupportedProducts = &quot;{!$Setup.zPaper_Settings__c.zPaper_Supported_Products__c}&quot;.toUpperCase().split(&quot;,&quot;).map(str =&gt; str.trim());

	if (sforce.console.isInConsole()) {
		if(zPaperSupportedProducts.includes(productName)) {
			srcUp(zPaperURL);
		} else {
			srcUp(generalURL);
		}
	} else {
		alert(&apos;Please open via Console&apos;);
	}
} catch(err) {
	alert(&quot;An error has occured&quot;);
}</url>
    </webLinks>
</CustomObject>
